# =============================================================================
# Solacore API - Environment Variables
# =============================================================================
# REQUIRED: Variables marked with [REQUIRED] must be set in production
# Copy this file to .env and update values
# =============================================================================

# -----------------------------------------------------------------------------
# Core Settings
# -----------------------------------------------------------------------------
# [REQUIRED] Set to false in production
DEBUG=true

# [REQUIRED] PostgreSQL connection string
# Format: postgresql+asyncpg://user:password@host:port/database
DATABASE_URL=postgresql+asyncpg://postgres:postgres@localhost:5432/solacore

# -----------------------------------------------------------------------------
# Database Connection (Operations/Backup)
# -----------------------------------------------------------------------------
# Host/port used by maintenance scripts (use db when running in Docker)
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=solacore

# Redis connection string (cache layer)
REDIS_URL=redis://localhost:6379/0

# [REQUIRED] JWT signing secret (generate with: openssl rand -hex 32)
JWT_SECRET=your-secret-key-change-in-production

# Server binding (usually no need to change)
HOST=0.0.0.0
PORT=8000

# App version (for health check)
APP_VERSION=1.0.0

# -----------------------------------------------------------------------------
# Free Beta Mode
# -----------------------------------------------------------------------------
# Enable free beta mode (relaxed limits, no payment enforcement)
# 内测阶段设为 true，用户无需登录即可使用
BETA_MODE=true

# Enable payment features (Stripe/RevenueCat)
# Set to false for free beta to disable all payment endpoints
PAYMENTS_ENABLED=false

# -----------------------------------------------------------------------------
# OAuth Configuration
# -----------------------------------------------------------------------------
# [REQUIRED] Google OAuth Client ID
# Get from: https://console.cloud.google.com/apis/credentials
GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com

# [REQUIRED] Apple Sign In Client ID (Bundle ID)
# Get from: https://developer.apple.com/account/resources/identifiers
APPLE_CLIENT_ID=com.yourapp.bundleid

# -----------------------------------------------------------------------------
# LLM Configuration
# -----------------------------------------------------------------------------
# [REQUIRED] Choose provider: openai, anthropic, or openrouter
LLM_PROVIDER=openai

# [REQUIRED if LLM_PROVIDER=openai] OpenAI API Key
# Get from: https://platform.openai.com/api-keys
OPENAI_API_KEY=sk-your-openai-key

# [REQUIRED if LLM_PROVIDER=anthropic] Anthropic API Key
# Get from: https://console.anthropic.com/settings/keys
ANTHROPIC_API_KEY=sk-ant-your-anthropic-key

# [REQUIRED if LLM_PROVIDER=openrouter] OpenRouter API Key
# Get from: https://openrouter.ai/keys
OPENROUTER_API_KEY=sk-or-your-openrouter-key

# Optional OpenRouter settings
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1
OPENROUTER_APP_NAME=Solacore
OPENROUTER_REFERER=https://solacore.app
# When true, use reasoning tokens if content tokens are empty
OPENROUTER_REASONING_FALLBACK=false

# Model configuration (sensible defaults)
LLM_MODEL=gpt-4o-mini
LLM_TIMEOUT=30
LLM_MAX_TOKENS=1024

# -----------------------------------------------------------------------------
# Stripe Configuration (Web Subscriptions)
# -----------------------------------------------------------------------------
# [REQUIRED] Stripe Secret Key
# Get from: https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=sk_test_your_key

# [REQUIRED] Stripe Webhook Secret
# Get from: https://dashboard.stripe.com/webhooks
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret

# [REQUIRED] Stripe Price IDs
# Get from: https://dashboard.stripe.com/products
STRIPE_PRICE_STANDARD=price_standard_monthly
STRIPE_PRICE_PRO=price_pro_monthly

# Redirect URLs after checkout
STRIPE_SUCCESS_URL=https://api.solacore.app/subscriptions/success?session_id={CHECKOUT_SESSION_ID}
STRIPE_CANCEL_URL=https://api.solacore.app/subscriptions/cancel

# -----------------------------------------------------------------------------
# RevenueCat Configuration (Mobile Subscriptions)
# -----------------------------------------------------------------------------
# [REQUIRED] RevenueCat Webhook Secret
# Get from: https://app.revenuecat.com/projects/xxx/settings/webhooks
REVENUECAT_WEBHOOK_SECRET=whsec_xxx

# [REQUIRED] RevenueCat Entitlement IDs
# Get from: https://app.revenuecat.com/projects/xxx/entitlements
REVENUECAT_ENTITLEMENT_STANDARD=standard_access
REVENUECAT_ENTITLEMENT_PRO=pro_access

# -----------------------------------------------------------------------------
# Monitoring (Optional)
# -----------------------------------------------------------------------------
# Sentry DSN for error tracking (leave empty to disable)
# Get from: https://sentry.io/settings/projects/xxx/keys/
SENTRY_DSN=

# Sentry environment tag
SENTRY_ENVIRONMENT=production

# Tracing sample rate (0.0 - 1.0)
SENTRY_TRACES_SAMPLE_RATE=0.1

# Prometheus / Grafana
PROMETHEUS_PORT=9090
PROMETHEUS_RETENTION_TIME=30d

GRAFANA_PORT=3000
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=change-me
GRAFANA_ANONYMOUS_ENABLED=false

# -----------------------------------------------------------------------------
# Backup Settings (Optional)
# -----------------------------------------------------------------------------
BACKUP_DIR=/backups
BACKUP_LOG_FILE=/backups/backup.log
BACKUP_RETENTION_DAYS=30
BACKUP_PG_DUMP_FLAGS=--no-owner --no-acl
BACKUP_RUN_CLEANUP=true

# Optional S3 sync
BACKUP_S3_BUCKET=
BACKUP_S3_PREFIX=
BACKUP_S3_REGION=
BACKUP_S3_STORAGE_CLASS=STANDARD

# AWS credentials for S3 (required if BACKUP_S3_BUCKET is set)
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=us-east-1

# Optional notifications
BACKUP_NOTIFY_WEBHOOK=
BACKUP_NOTIFY_CMD=
